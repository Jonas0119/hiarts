// 导入翻译文本
const translations = {
  'en': {
    "goodsDetail": {
      "goodsDetail": "Product details",
      "orderPay": "Order payment",
      "saleTime": "Sale stop time",
      "saleProgress": "Product application progress",
      "goodPrice": "Unit price of goods",
      "num": "Quantity issued",
      "shopinfor": "Quality store recommendation",
      "shotContent": "Product Description",
      "tips": "Purchase Instructions",
      "description": "Product description",
      "buyNum": "Subscription quantity",
      "tipsWord": "You are welcome to participate in the purchase of this product, in order to let you fully understand the product content, this 'Purchase Instructions' is provided. If you choose to participate in the purchase of this product, it is deemed that you have carefully read the Purchase Instructions and voluntarily assume the risk caused by the purchase of this data asset. When you purchase the products of the Center, you need to be aware in advance that the data asset products sold by the platform are tagged with related products, rights and interests by blockchain technology to confirm your rights and interests in the product.",
      "buy": "Purchase",
      "ali": "Alipay",
      "wechat": "WeChat Pay",
      "confirmPay": "Confirm payment",
      "backhome": "Return to home page",
      "success": "Payment success"
    },
    "index": {
      "all": "All",
      "goods": "Goods",
      "liveHL": "Real-time exchange rate",
      "category1": "Data Trade",
      "category2": "Art Pass",
      "category3": "Version Pass",
      "category4": "Travel Pass",
      "category5": "Finance Pass",
      "category6": "Rights Pass",
      "home": "Home",
      "mine": "Mine",
      "exchange": "Exchange Rate",
      "updateTime": "(updated after 10s)",
      "hkd": "HKD/CNY",
      "views": "views",
      "users": "users",
      "news": "News",
      "newsDetail": "Detail",
      "times": "Time",
      "navBtn": "Language"
    },
    "login": {
      "phone": "Please enter phone number",
      "code": "Please enter verification code",
      "login": "Login",
      "agree": "Have read and agree",
      "user": "User Agreement",
      "privacy": "Privacy Agreement",
      "and": "and"
    },
    "goods": {
      "list": {
        "price": "Unit price",
        "unit": "unit",
        "wait": "for sale",
        "unbuy": "Pending Sale",
        "buying": "On Sale",
        "stopbuy": "Sold Out"
      },
      "detail": {
        "goodsDetail": "Product details",
        "orderPay": "Order payment",
        "saleTime": "Sale stop time",
        "saleProgress": "Product application progress",
        "goodPrice": "Unit price of goods",
        "num": "Quantity issued",
        "shopinfor": "Quality store recommendation",
        "shortContent": "Product Description",
        "tips": "Purchase Instructions",
        "description": "Product description",
        "buyNum": "Subscription quantity",
        "tipsWord": "You are welcome to participate in the purchase of this product, in order to let you fully understand the product content, this 'Purchase Instructions' is provided. If you choose to participate in the purchase of this product, it is deemed that you have carefully read the Purchase Instructions and voluntarily assume the risk caused by the purchase of this data asset. When you purchase the products of the Center, you need to be aware in advance that the data asset products sold by the platform are tagged with related products, rights and interests by blockchain technology to confirm your rights and interests in the product.",
        "buy": "Purchase",
        "ali": "Alipay",
        "wechat": "WeChat Pay",
        "confirmPay": "Confirm payment",
        "backhome": "Return to home page",
        "success": "Payment success"
      }
    },
    "mine": {
      "mine": "My",
      "myOrder": "My subscription product",
      "invite": "Invitation",
      "myInvite": "My invite",
      "invitationIntro": "My QR code",
      "address": "Address Management",
      "about": "About us",
      "default": "Default",
      "addAddress": "Add address",
      "addressMGMT": "Address Management",
      "receiveName": "Consignee name",
      "receivePhone": "Consignee mobile phone",
      "receiveAddress": "Consignee address",
      "defaultAddress": "Default address",
      "inputAddress": "Please enter detailed address",
      "inputPhone": "Please enter phone",
      "inputName": "Please enter your name",
      "del": "Delete",
      "save": "Save",
      "tradeRule": "Trading rules",
      "chargeRule": "Charging rules",
      "memberRule": "Member Rule",
      "privacyRule": "Privacy Policy",
      "userAgreement": "User Agreement",
      "invitedPeople": "My invite",
      "inviteDetail": "detail>",
      "people": "People",
      "cumulativeInvitations": "Cumulative invitations",
      "noMore": "No more data",
      "invitee": "Invitee",
      "registrationDate": "Registration Date"
    },
    "order": {
      "pay": "Actual payment",
      "payOrder": "Pay",
      "confirm": "Confirm receipt",
      "askget": "Request for delivery",
      "orderNo": "Order number",
      "orderTime": "Order time",
      "getInfo": "Receiving information",
      "getAddress": "Shipping address",
      "getTime": "Request for delivery time",
      "tiInfo": "Delivery information",
      "tiTime": "Pick-up time",
      "choseAdd": "Select address",
      "tiTips": "Delivery Instructions (50 words or less)",
      "input": "Fill in special instructions and requirements",
      "submit": "Submit",
      "unget": "To be picked up",
      "unPay": "To be paid",
      "unsend": "To be sent",
      "sended": "Shipped",
      "done": "Done",
      "Logistics": "Logistics information",
      "detail": "Order details",
      "bankPay": "Bank transfer",
      "wechatPay": "WeChat payment",
      "payMethod": "Payment method"
    },
    "common": {
      "nodata": "No data yet",
      "out": "Exit safely",
      "choseAdd": "Please select an address",
      "success": "Operation success",
      "delsuccess": "Delete successfully",
      "tipName": "Please enter your name",
      "tipPhone": "Please enter phone number",
      "tipAdd": "Please enter full address",
      "soon": "Available later",
      "getCode": "Get code",
      "inputCode": "Please enter verification code",
      "gou": "Please tick Yes",
      "reGet": "Reget code",
      "tipNum": "Please enter quantity",
      "tipTopNum": "Exceeds the quantity available for purchase",
      "tipLogin": "Please go to login",
      "loading": "Loading...",
      "copied": "Copied",
      "saving": "Saving...",
      "saved": "Saved",
      "saveFailed": "Save failed",
      "login": "Please login first",
      "loadFailed": "Load failed",
      "networkError": "Network request failed",
      "requestFailed": "Request failed",
      "contactManager": "Please contact customer manager",
      "payFailed": "Pay failed or User Cancelled"
    },
    "navigationBarTitles": {
      "pages.index.index": "HiArts",
      "pages.login.index": "Login On",
      "pages.goods.list": "Products",
      "pages.goods.detail": "Product Details",
      "pages.goods.typeList": "Products",
      "pages.goods.pay": "Place Order",
      "pages.goods.payIndex": "Payment Center",
      "pages.mine.index": "My Profile",
      "pages.mine.settings": "Settings",
      "pages.mine.privacy": "Privacy Policy",
      "pages.mine.orderList": "My Orders",
      "pages.mine.orderDetail": "Order Details",
      "pages.mine.mineInvite": "My Invitations",
      "pages.mine.addressList": "Address Management",
      "pages.mine.addressForm": "Edit Address",
      "pages.mine.about": "About Us",
      "pages.mine.user": "User Agreement"
    },
    "tabBar": {
      "home": "Home",
      "goods": "Products",
      "mine": "Mine"
    },
    "chart": {
      "currency": {
        "title": "Exchange Rate Trend",
        "yAxisName": "Exchange Rate",
        "xAxisName": "Time"
      },
      "statistics": {
        "views": "Page Views",
        "users": "Total Users",
        "orders": "Total Orders"
      }
    },
    "validation": {
      "required": "This field is required",
      "phone": "Please enter a valid phone number",
      "email": "Please enter a valid email address",
      "number": "Please enter a valid number",
      "maxLength": "Maximum length exceeded",
      "minLength": "Minimum length not met"
    },
    "error": {
      "network": "Network error, please try again",
      "server": "Server error, please try again later",
      "auth": "Authentication failed",
      "permission": "No permission",
      "validation": "Validation failed",
      "unknown": "Unknown error occurred"
    },
    "language": {
      "current": "Current Language",
      "traditional": "Traditional Chinese",
      "simplified": "Simplified Chinese",
      "english": "English"
    }
  },
  'zh-Hant': {
    "index": {
      "all": "全部",
      "goods": "推薦商品",
      "liveHL": "實時匯率",
      "category1": "數貿通",
      "category2": "數藝通",
      "category3": "數版通",
      "category4": "數旅通",
      "category5": "數融通",
      "category6": "數權通",
      "home": "首頁",
      "mine": "我的",
      "exchange": "實時匯率",
      "updateTime": "（10s后自動更新）",
      "hkd": "港幣/人民幣",
      "views": "瀏覽量(次)",
      "users": "會員數(人)",
      "news": "動態",
      "newsDetail": "動態詳情",
      "times": "發佈日期",
      "navBtn": "繁/英轉換"
    },
    "login": {
      "phone": "請輸入手機號",
      "code": "請輸入驗證碼",
      "login": "登錄",
      "agree": "已閱讀并同意",
      "user": "用戶協議",
      "privacy": "隱私協議",
      "and": "和"
    },
    "goods": {
      "list": {
        "price": "單價",
        "unit": "份",
        "wait": "待售",
        "unbuy": "待審購",
        "buying": "審購中",
        "stopbuy": "停止審購"
      },
      "detail": {
        "goodsDetail": "商品詳情",
        "orderPay": "訂單支付",
        "saleTime": "發售停止時間",
        "saleProgress": "商品申購進度",
        "goodPrice": "商品單價",
        "num": "發行數量",
        "shopinfor": "優質店鋪推薦",
        "shortContent": "商品簡介",
        "tips": "申購須知",
        "description": "商品描述",
        "buyNum": "申購數量",
        "tipsWord": "歡迎您參與購買本產品...",
        "buy": "申購",
        "ali": "支付寶",
        "wechat": "微信支付",
        "confirmPay": "確認支付",
        "backhome": "返回首頁",
        "success": "支付成功"
      }
    },
    "mine": {
      "mine": "我的",
      "myOrder": "我的申購產品",
      "invite": "邀請好友",
      "myInvite": "我邀請的用戶",
      "invitationIntro": "我的二維碼",
      "address": "地址管理",
      "about": "關於我們",
      "default": "默認",
      "addAddress": "新增地址",
      "addressMGMT": "地址管理",
      "receiveName": "收貨人姓名",
      "receivePhone": "收貨人手機",
      "receiveAddress": "收貨人地址",
      "defaultAddress": "默認地址",
      "inputAddress": "請輸入詳細地址",
      "inputPhone": "請輸入手機",
      "inputName": "請輸入姓名",
      "del": "刪除",
      "save": "保存",
      "tradeRule": "交易規則",
      "chargeRule": "收費規則",
      "memberRule": "會員規則",
      "privacyRule": "隱私條款",
      "userAgreement": "用戶協議",
      "invitedPeople": "我已累計邀請用戶",
      "inviteDetail": "詳情>",
      "people": "人",
      "cumulativeInvitations": "纍計邀請",
      "noMore": "暫無更多數據",
      "invitee": "被邀請人",
      "registrationDate": "註冊日期"
    },
    "order": {
      "pay": "實付款",
      "payOrder": "立即支付",
      "confirm": "確認收貨",
      "askget": "申請提貨",
      "orderNo": "訂單編號",
      "orderTime": "下單時間",
      "getInfo": "收貨信息",
      "getAddress": "收貨地址",
      "getTime": "申請提貨時間",
      "tiInfo": "提貨信息",
      "tiTime": "提貨時間",
      "choseAdd": "選擇地址",
      "tiTips": "提貨説明（50字以内）",
      "input": "填寫特殊説明事項和要求",
      "submit": "提交",
      "unget": "待提貨",
      "unPay": "待支付",
      "unsend": "待發貨",
      "sended": "已發貨",
      "done": "已完成",
      "Logistics": "物流信息",
      "detail": "訂單詳情",
      "bankPay": "網銀轉賬",
      "wechatPay": "微信付款",
      "payMethod": "付款方式"
    },
    "common": {
      "nodata": "暫無數據",
      "out": "安全退出",
      "choseAdd": "請選擇地址",
      "success": "操作成功",
      "delsuccess": "刪除成功",
      "tipName": "請輸入姓名",
      "tipPhone": "請輸入手機號",
      "tipAdd": "請輸入完整地址",
      "soon": "稍後開放",
      "getCode": "獲取驗證碼",
      "inputCode": "請輸入驗證碼",
      "gou": "請勾選同意",
      "reGet": "重新獲取",
      "tipNum": "請輸入數量",
      "tipTopNum": "超過可購買數量",
      "tipLogin": "請去登錄",
      "loading": "加載中...",
      "copied": "已複製",
      "saving": "保存中...",
      "saved": "已保存",
      "saveFailed": "保存失敗",
      "login": "請先登錄",
      "loadFailed": "加載失敗",
      "networkError": "網絡請求失敗",
      "requestFailed": "請求失敗",
      "contactManager": "請聯繫客戶經理",
      "payFailed": "支付失敗或用戶取消"
    },
    "navigationBarTitles": {
      "pages.index.index": "港藝",
      "pages.login.index": "登錄",
      "pages.goods.list": "商品列表",
      "pages.goods.detail": "商品詳情",
      "pages.goods.typeList": "商品列表",
      "pages.goods.pay": "商品下單",
      "pages.goods.payIndex": "支付中心",
      "pages.mine.index": "個人中心",
      "pages.mine.settings": "設置",
      "pages.mine.privacy": "隱私政策",
      "pages.mine.orderList": "我的訂單",
      "pages.mine.orderDetail": "訂單詳情",
      "pages.mine.mineInvite": "我的邀請",
      "pages.mine.addressList": "地址管理",
      "pages.mine.addressForm": "編輯地址",
      "pages.mine.about": "關於我們",
      "pages.mine.user": "用戶協議"
    },
    "tabBar": {
      "home": "首頁",
      "goods": "商品",
      "mine": "我的"
    },
    "components": {
      "navigationBar": {
        "back": "返回",
        "home": "首頁",
        "loading": "加載中"
      },
      "empty": {
        "noData": "暫無數據",
        "tryAgain": "重試"
      },
      "loading": {
        "loading": "加載中...",
        "wait": "請稍候"
      }
    },
    "chart": {
      "currency": {
        "title": "匯率走勢",
        "yAxisName": "匯率",
        "xAxisName": "時間"
      },
      "statistics": {
        "views": "頁面瀏覽",
        "users": "總用戶數",
        "orders": "總訂單數"
      }
    },
    "validation": {
      "required": "此欄位為必填",
      "phone": "請輸入有效的手機號碼",
      "email": "請輸入有效的電子郵件",
      "number": "請輸入有效的數字",
      "maxLength": "超出最大長度",
      "minLength": "未達到最小長度"
    },
    "error": {
      "network": "網絡錯誤，請重試",
      "server": "服務器錯誤，請稍後重試",
      "auth": "認證失敗",
      "permission": "無權限",
      "validation": "驗證失敗",
      "unknown": "發生未知錯誤"
    },
    "language": {
      "current": "當前語言",
      "traditional": "繁體中文",
      "simplified": "简体中文",
      "english": "English"
    }
  },
  'zh-Hans': {
    "language": {
      english: '英文',
      simplified: '简体中文',
      traditional: '繁体中文',
      current: '当前语言'
    },
    "goods": {
      "list": {
        "price": "单价",
        "unit": "份",
        "wait": "待售",
        "unbuy": "待审购",
        "buying": "审购中",
        "stopbuy": "停止审购"
      },
      "detail": {
        "goodsDetail": "商品详情",
        "orderPay": "订单支付",
        "saleTime": "发售停止时间",
        "saleProgress": "商品申购进度",
        "goodPrice": "商品单价",
        "num": "发行数量",
        "shopinfor": "优质店铺推荐",
        "shortContent": "商品简介",
        "tips": "申购须知",
        "description": "商品描述",
        "buyNum": "申购数量",
        "tipsWord": "欢迎您参与购买本产品，为了让您充分了解产品内容，特提供本《购买须知》。若您选择参与本产品购买，则视为您已仔细阅读本《购买须知》并自愿承担购买本数据资产所带来的风险。在您购买本中心产品时需提前知悉，本平台所发售的数据资产产品是以区块链技术将相关产品、权益等资产上链标记，以确认您对该产品的权益。",
        "buy": "申购",
        "ali": "支付宝",
        "wechat": "微信支付",
        "confirmPay": "确认支付",
        "backhome": "返回首页",
        "success": "支付成功"
      }
    },
    "login": {
      "phone": "请输入手机号",
      "code": "请输入验证码",
      "login": "登录",
      "agree": "已阅读并同意",
      "user": "用户协议",
      "privacy": "隐私协议",
      "and": "和"
    },
    "index": {
      "all": "全部",
      "goods": "推荐商品",
      "liveHL": "实时汇率",
      "category1": "数贸通",
      "category2": "数艺通",
      "category3": "数版通",
      "category4": "数旅通",
      "category5": "数融通",
      "category6": "数权通",
      "home": "首页",
      "mine": "我的",
      "exchange": "实时汇率",
      "updateTime": "（10s后自动更新）",
      "hkd": "港币/人民币",
      "views": "浏览量(次)",
      "users": "会员数(人)",
      "news": "动态",
      "newsDetail": "动态详情",
      "times": "发布日期",
      "navBtn": "语言切换"
    },
    "login": {
      "phone": "请输入手机号",
      "code": "请输入验证码",
      "login": "登录",
      "agree": "已阅读并同意",
      "user": "用户协议",
      "privacy": "隐私协议",
      "and": "和"
    },
    "settings": {
      "language": "语言",
      "notification": "通知设置",
      "clearCache": "清除缓存",
      "checkUpdate": "检查更新",
      "privacy": "隐私",
      "terms": "条款",
      "logout": "退出登录"
    },
    "mine": {
      "mine": "我的",
      "myOrder": "我的申购产品",
      "invite": "邀请好友",
      "myInvite": "我邀请的用户",
      "invitationIntro": "我的二维码",
      "address": "地址管理",
      "about": "关于我们",
      "default": "默认",
      "addAddress": "新增地址",
      "addressMGMT": "地址管理",
      "receiveName": "收货人姓名",
      "receivePhone": "收货人手机",
      "receiveAddress": "收货人地址",
      "defaultAddress": "默认地址",
      "inputAddress": "请输入详细地址",
      "inputPhone": "请输入手机",
      "inputName": "请输入姓名",
      "del": "删除",
      "save": "保存",
      "tradeRule": "交易规则",
      "chargeRule": "收费规则",
      "memberRule": "会员规则",
      "privacyRule": "隐私条款",
      "userAgreement": "用户协议",
      "invitedPeople": "我已累计邀请用户",
      "inviteDetail": "详情>",
      "people": "人",
      "cumulativeInvitations": "累计邀请",
      "noMore": "暂无更多数据",
      "invitee": "被邀请人",
      "registrationDate": "注册日期"
    },
    "order": {
      "pay": "实付款",
      "payOrder": "立即支付",
      "confirm": "确认收货",
      "askget": "申请提货",
      "orderNo": "订单编号",
      "orderTime": "下单时间",
      "getInfo": "收货信息",
      "getAddress": "收货地址",
      "getTime": "申请提货时间",
      "tiInfo": "提货信息",
      "tiTime": "提货时间",
      "choseAdd": "选择地址",
      "tiTips": "提货说明（50字以内）",
      "input": "填写特殊说明事项和要求",
      "submit": "提交",
      "unget": "待提货",
      "unPay": "待支付",
      "unsend": "待发货",
      "sended": "已发货",
      "done": "已完成",
      "Logistics": "物流信息",
      "detail": "订单详情",
      "bankPay": "网银转账",
      "wechatPay": "微信付款",
      "payMethod": "付款方式"
    },
    "common": {
      "nodata": "暂无数据",
      "out": "安全退出",
      "choseAdd": "请选择地址",
      "success": "操作成功",
      "delsuccess": "删除成功",
      "tipName": "请输入姓名",
      "tipPhone": "请输入手机号",
      "tipAdd": "请输入详细地址",
      "soon": "稍后提供",
      "getCode": "获取验证码",
      "inputCode": "请输入验证码",
      "gou": "请勾选同意",
      "reGet": "重新获取",
      "tipNum": "请输入数量",
      "tipTopNum": "超出可购买数量",
      "tipLogin": "请去登录",
      "loading": "加载中...",
      "copied": "已复制",
      "saving": "保存中...",
      "saved": "已保存",
      "saveFailed": "保存失败",
      "pleaseInput": "请输入",
      "fail": "操作失败",
      "networkError": "网络异常",
      "payFailed": "支付失败或用户取消付款"
    },
    "components": {
      "navigationBar": {
        "back": "返回",
        "home": "首页",
        "loading": "加载中"
      },
      "empty": {
        "noData": "暂无数据",
        "tryAgain": "重试"
      },
      "loading": {
        "loading": "加载中...",
        "wait": "请稍候"
      }
    },
    "chart": {
      "currency": {
        "title": "汇率走势",
        "yAxisName": "汇率",
        "xAxisName": "时间"
      },
      "statistics": {
        "views": "页面浏览",
        "users": "总用户数",
        "orders": "总订单数"
      }
    },
    "validation": {
      "required": "此栏位为必填",
      "phone": "请输入有效的手机号码",
      "email": "请输入有效的电子邮件",
      "number": "请输入有效的数字",
      "maxLength": "超出最大长度",
      "minLength": "未达到最小长度"
    },
    "error": {
      "network": "网络错误，请重试",
      "server": "服务器错误，请稍后重试",
      "auth": "认证失败",
      "permission": "无权限",
      "validation": "验证失败",
      "unknown": "发生未知错误"
    },
    "navigationBarTitles": {
      "pages.index.index": "港艺",
      "pages.login.index": "登录",
      "pages.goods.list": "商品列表",
      "pages.goods.detail": "商品详情",
      "pages.goods.typeList": "商品列表",
      "pages.goods.pay": "商品下单",
      "pages.goods.payIndex": "支付中心",
      "pages.mine.index": "个人中心",
      "pages.mine.settings": "设置",
      "pages.mine.privacy": "隐私政策",
      "pages.mine.orderList": "我的订单",
      "pages.mine.orderDetail": "订单详情",
      "pages.mine.mineInvite": "我的邀请",
      "pages.mine.addressList": "地址管理",
      "pages.mine.addressForm": "编辑地址",
      "pages.mine.about": "关于我们",
      "pages.mine.user": "用户协议"
    },
    "tabBar": {
      "home": "首页",
      "goods": "商品",
      "mine": "我的"
    }
  }
}

// 默认语言
const DEFAULT_LANGUAGE = 'zh-Hant'

// 支持的语言列表
const SUPPORTED_LANGUAGES = {
  'zh-Hant': '繁體中文',
  'zh-Hans': '简体中文',
  'en': 'English'
}

// 获取当前语言
const getCurrentLanguage = () => {
  return wx.getStorageSync('locale') || DEFAULT_LANGUAGE
}

// 设置语言
const setLanguage = (lang) => {
  if (SUPPORTED_LANGUAGES[lang]) {
    wx.setStorageSync('locale', lang)
    // 触发语言变化事件
    wx.eventCenter = wx.eventCenter || {}
    wx.eventCenter.languageChanged = true
    // 通知所有页面语言已更改
    const pages = getCurrentPages()
    pages.forEach(page => {
      if (page && typeof page.onLocaleChange === 'function') {
        page.onLocaleChange()
      }
    })
  }
}

// 获取翻译文本
const t = (key, locale = null) => {
  const currentLocale = locale || getCurrentLanguage()
  console.log('[i18n] Getting translation for key:', key, 'locale:', currentLocale)
  const keys = key.split('.')
  let value = translations[currentLocale]

  for (const k of keys) {
    if (value && value[k]) {
      value = value[k]
    } else {
      console.warn(`Translation key not found: ${key} for locale: ${currentLocale}`)
      return key
    }
  }
  
  console.log('[i18n] Translation result:', value)
  return value
}

// 获取支持的语言列表
const getSupportedLanguages = () => {
  return SUPPORTED_LANGUAGES
}

// 获取当前页面路径对应的标题key
const getPageTitleKey = (pagePath) => {
  // 处理分包路径
  if (pagePath.startsWith('packageMine/pages/')) {
    // 将 packageMine/pages/xxx/index/index 转换为 pages.mine.xxx
    const parts = pagePath.split('/')
    return `pages.mine.${parts[2]}`
  } else if (pagePath.startsWith('packageGoods/pages/')) {
    // 将 packageGoods/pages/xxx/index/index 转换为 pages.goods.xxx
    const parts = pagePath.split('/')
    return `pages.goods.${parts[2]}`
  }
  
  // 处理主包路径
  return pagePath.replace(/^\//, '.').replace(/\//g, '.')
}

// 更新导航栏标题
const updateNavigationBarTitle = () => {
  const pages = getCurrentPages();
  if (pages.length > 0) {
    const currentPage = pages[pages.length - 1];
    const route = currentPage.route;
    const titleKey = getPageTitleKey(route);
    const currentLang = getCurrentLanguage();
    const title = translations[currentLang]?.navigationBarTitles?.[titleKey];
    
    console.log("[Navigation] Current route:" + route 
      + " Current language:" + currentLang 
      + " Found title:" + title);
    
    if (title) {
      wx.setNavigationBarTitle({
        title: title
      });
    }
  }
};

module.exports = {
  t,
  updateNavigationBarTitle,
  getPageTitleKey,
  getCurrentLanguage,
  setLanguage,
  getSupportedLanguages,
  SUPPORTED_LANGUAGES
}
